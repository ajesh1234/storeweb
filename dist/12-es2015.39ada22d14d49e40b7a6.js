(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{Ityv:function(t,i,o){"use strict";o.r(i),o.d(i,"ForgotModule",function(){return S});var e=o("SVse"),r=o("H+bZ"),s=o("2Rin"),c=o("PSD3"),n=o.n(c),l=o("JZFu"),a=o("8Y7J"),u=o("7g+E"),h=o("s7LF"),d=o("BstE");const p=function(){return{width:"40px",height:"40px",border:"1px solid lightgray","background-color":"white"}},b=function(t){return{length:6,inputStyles:t}};function g(t,i){if(1&t){const t=a.cc();a.bc(0,"div",21),a.bc(1,"p"),a.Hc(2),a.ac(),a.bc(3,"ng-otp-input",22),a.ic("onInputChange",function(i){return a.Bc(t),a.lc(2).onOtpChange(i)}),a.ac(),a.ac()}if(2&t){const t=a.lc(2);a.Jb(2),a.Jc("",t.util.translate("Enter OTP")," "),a.Jb(1),a.rc("config",a.wc(3,b,a.vc(2,p)))}}function f(t,i){if(1&t){const t=a.cc();a.bc(0,"button",23),a.ic("click",function(){return a.Bc(t),a.lc(2).goToTabs()}),a.Hc(1),a.ac()}if(2&t){const t=a.lc(2);a.Jb(1),a.Ic(t.util.translate("Send OTP"))}}function m(t,i){if(1&t){const t=a.cc();a.bc(0,"button",23),a.ic("click",function(){return a.Bc(t),a.lc(2).verifyOTP()}),a.Hc(1),a.ac()}if(2&t){const t=a.lc(2);a.Jb(1),a.Ic(t.util.translate("Verify OTP"))}}const v=function(){return{standalone:!0}};function w(t,i){if(1&t){const t=a.cc();a.bc(0,"form"),a.bc(1,"div",10),a.Wb(2,"img",11),a.ac(),a.bc(3,"h1"),a.Hc(4),a.ac(),a.bc(5,"p",12),a.Hc(6),a.ac(),a.bc(7,"div",13),a.bc(8,"div",14),a.bc(9,"span",15),a.Wb(10,"i",16),a.ac(),a.ac(),a.bc(11,"input",17),a.ic("ngModelChange",function(i){return a.Bc(t),a.lc().email=i}),a.ac(),a.ac(),a.Gc(12,g,4,5,"div",18),a.bc(13,"div",4),a.bc(14,"div",19),a.Gc(15,f,2,1,"button",20),a.Gc(16,m,2,1,"button",20),a.ac(),a.ac(),a.ac()}if(2&t){const t=a.lc();a.Jb(4),a.Ic(t.util.translate("Reset Password")),a.Jb(2),a.Ic(t.util.translate("Send OTP")),a.Jb(5),a.rc("ngModel",t.email)("placeholder",t.util.translate("Email address"))("ngModelOptions",a.vc(8,v)),a.Jb(1),a.rc("ngIf",1==t.otpSent),a.Jb(3),a.rc("ngIf",0==t.otpSent),a.Jb(1),a.rc("ngIf",1==t.otpSent)}}function P(t,i){if(1&t){const t=a.cc();a.bc(0,"form"),a.bc(1,"div",10),a.Wb(2,"img",11),a.ac(),a.bc(3,"h1"),a.Hc(4),a.ac(),a.bc(5,"p",12),a.Hc(6),a.ac(),a.bc(7,"div",24),a.bc(8,"div",14),a.bc(9,"span",15),a.Wb(10,"i",25),a.ac(),a.ac(),a.bc(11,"input",26),a.ic("ngModelChange",function(i){return a.Bc(t),a.lc().password=i}),a.ac(),a.ac(),a.bc(12,"div",24),a.bc(13,"div",14),a.bc(14,"span",15),a.Wb(15,"i",25),a.ac(),a.ac(),a.bc(16,"input",26),a.ic("ngModelChange",function(i){return a.Bc(t),a.lc().confirm=i}),a.ac(),a.ac(),a.bc(17,"div",4),a.bc(18,"div",19),a.bc(19,"button",23),a.ic("click",function(){return a.Bc(t),a.lc().updatePassword()}),a.Hc(20),a.ac(),a.ac(),a.ac(),a.ac()}if(2&t){const t=a.lc();a.Jb(4),a.Ic(t.util.translate("Reset Password")),a.Jb(2),a.Ic(t.util.translate("Update Password")),a.Jb(5),a.rc("ngModel",t.password)("placeholder",t.util.translate("Password"))("ngModelOptions",a.vc(9,v)),a.Jb(5),a.rc("ngModel",t.confirm)("placeholder",t.util.translate("Confirm Password"))("ngModelOptions",a.vc(10,v)),a.Jb(4),a.Ic(t.util.translate("Update"))}}function y(t,i){if(1&t&&(a.bc(0,"option",33),a.Hc(1),a.ac()),2&t){const t=i.$implicit;a.rc("value",t.dialling_code),a.Jb(1),a.Jc(" ",t.country_name," ")}}function _(t,i){if(1&t){const t=a.cc();a.bc(0,"div"),a.bc(1,"select",31),a.ic("ngModelChange",function(i){return a.Bc(t),a.lc(2).country_code=i}),a.Gc(2,y,2,2,"option",32),a.ac(),a.ac()}if(2&t){const t=a.lc(2);a.Jb(1),a.rc("ngModel",t.country_code)("ngModelOptions",a.vc(3,v)),a.Jb(1),a.rc("ngForOf",t.util.countrys)}}function O(t,i){if(1&t){const t=a.cc();a.bc(0,"div"),a.bc(1,"input",34),a.ic("ngModelChange",function(i){return a.Bc(t),a.lc(2).country_code=i}),a.ac(),a.ac()}if(2&t){const t=a.lc(2);a.Jb(1),a.rc("ngModel",t.country_code)("placeholder",t.util.translate("Country Code"))("disabled",!0)("ngModelOptions",a.vc(4,v))}}function J(t,i){if(1&t){const t=a.cc();a.bc(0,"div",21),a.bc(1,"p"),a.Hc(2,"Enter OTP"),a.ac(),a.bc(3,"ng-otp-input",22),a.ic("onInputChange",function(i){return a.Bc(t),a.lc(2).onOtpChange(i)}),a.ac(),a.ac()}2&t&&(a.Jb(3),a.rc("config",a.wc(2,b,a.vc(1,p))))}function T(t,i){if(1&t){const t=a.cc();a.bc(0,"button",23),a.ic("click",function(){return a.Bc(t),a.lc(2).sendPhoneOTP()}),a.Hc(1),a.ac()}if(2&t){const t=a.lc(2);a.Jb(1),a.Ic(t.util.translate("Send OTP"))}}function M(t,i){if(1&t){const t=a.cc();a.bc(0,"button",23),a.ic("click",function(){return a.Bc(t),a.lc(2).verifyOTP()}),a.Hc(1),a.ac()}if(2&t){const t=a.lc(2);a.Jb(1),a.Ic(t.util.translate("Verify OTP"))}}function I(t,i){if(1&t){const t=a.cc();a.bc(0,"form"),a.bc(1,"div",10),a.Wb(2,"img",11),a.ac(),a.bc(3,"h1"),a.Hc(4),a.ac(),a.bc(5,"p",12),a.Hc(6),a.ac(),a.bc(7,"div",4),a.bc(8,"div",27),a.Gc(9,_,3,4,"div",9),a.Gc(10,O,2,5,"div",9),a.ac(),a.bc(11,"div",28),a.bc(12,"div",13),a.bc(13,"div",14),a.bc(14,"span",15),a.Wb(15,"i",29),a.ac(),a.ac(),a.bc(16,"input",30),a.ic("ngModelChange",function(i){return a.Bc(t),a.lc().mobile=i}),a.ac(),a.ac(),a.ac(),a.ac(),a.Gc(17,J,4,4,"div",18),a.bc(18,"div",4),a.bc(19,"div",19),a.Gc(20,T,2,1,"button",20),a.Gc(21,M,2,1,"button",20),a.ac(),a.ac(),a.ac()}if(2&t){const t=a.lc();a.Jb(4),a.Ic(t.util.translate("Reset Password")),a.Jb(2),a.Ic(t.util.translate("Send OTP")),a.Jb(3),a.rc("ngIf",null==t.util.countrys?null:t.util.countrys.length),a.Jb(1),a.rc("ngIf",!(null!=t.util.countrys&&t.util.countrys.length)),a.Jb(6),a.rc("ngModel",t.mobile)("placeholder",t.util.translate("Phone"))("ngModelOptions",a.vc(10,v)),a.Jb(1),a.rc("ngIf",1==t.otpSent),a.Jb(3),a.rc("ngIf",0==t.otpSent),a.Jb(1),a.rc("ngIf",1==t.otpSent)}}function C(t,i){if(1&t){const t=a.cc();a.bc(0,"form"),a.bc(1,"div",10),a.Wb(2,"img",11),a.ac(),a.bc(3,"h1"),a.Hc(4),a.ac(),a.bc(5,"p",12),a.Hc(6),a.ac(),a.bc(7,"div",24),a.bc(8,"div",14),a.bc(9,"span",15),a.Wb(10,"i",25),a.ac(),a.ac(),a.bc(11,"input",26),a.ic("ngModelChange",function(i){return a.Bc(t),a.lc().password=i}),a.ac(),a.ac(),a.bc(12,"div",24),a.bc(13,"div",14),a.bc(14,"span",15),a.Wb(15,"i",25),a.ac(),a.ac(),a.bc(16,"input",26),a.ic("ngModelChange",function(i){return a.Bc(t),a.lc().confirm=i}),a.ac(),a.ac(),a.bc(17,"div",4),a.bc(18,"div",19),a.bc(19,"button",23),a.ic("click",function(){return a.Bc(t),a.lc().updatePassword()}),a.Hc(20),a.ac(),a.ac(),a.ac(),a.ac()}if(2&t){const t=a.lc();a.Jb(4),a.Ic(t.util.translate("Reset Password")),a.Jb(2),a.Ic(t.util.translate("Update Password")),a.Jb(5),a.rc("ngModel",t.password)("placeholder",t.util.translate("Password"))("ngModelOptions",a.vc(9,v)),a.Jb(5),a.rc("ngModel",t.confirm)("placeholder",t.util.translate("Confirm Password"))("ngModelOptions",a.vc(10,v)),a.Jb(4),a.Ic(t.util.translate("Update"))}}let W=(()=>{class t{constructor(t,i,o){this.api=t,this.util=i,this.location=o,this.div=1,this.otp_id="",this.email="",this.otpSent=!1,this.otp="",this.password="",this.confirm="",this.temp="",this.country_code="",this.mobile="",setTimeout(()=>{this.country_code=this.util.default_country_code},1e3)}ngOnInit(){setTimeout(()=>{this.recaptchaVerifier=new l.a.auth.RecaptchaVerifier("sign-in-button",{size:"invisible",callback:t=>{},"expired-callback":()=>{}})},5e3)}onOtpChange(t){console.log(t),this.otp=t}goToTabs(){if(!/^[\w._-]+[+]?[\w._-]+@[\w.-]+\.[a-zA-Z]{2,6}$/.test(this.email))return this.util.error(this.util.translate("Please enter valid email")),!1;console.log("login"),this.util.show(),this.api.post_public("v1/auth/verifyEmailForReset",{email:this.email}).then(t=>{console.log(t),this.util.hide(),t&&t.status&&200===t.status&&!0===t.data&&t.otp_id?(this.otpSent=!0,this.otp_id=t.otp_id):t&&t.status&&500===t.status&&!1===t.data&&this.util.error(t.message)},t=>{this.util.hide(),this.util.apiErrorHandler(t)}).catch(t=>{this.util.hide(),console.log(t),this.util.apiErrorHandler(t)})}goToBack(){this.location.back()}sendPhoneOTP(){if("2"==this.util.smsGateway){const t={country_code:"+"+this.country_code,mobile:this.mobile};this.util.show(),this.api.post_public("v1/auth/verifyPhoneForFirebase",t).then(i=>{console.log(i),this.util.hide(),i&&i.status&&200==i.status&&i.data&&(console.log("open firebase web version"),this.util.show(),this.api.signInWithPhoneNumber(this.recaptchaVerifier,t.country_code+t.mobile).then(t=>{this.util.hide(),this.otpSent=!0}).catch(t=>{this.util.hide(),console.log(t),this.util.error(t)}))},t=>{this.util.hide(),this.util.apiErrorHandler(t)}).catch(t=>{this.util.hide(),console.log(t),this.util.apiErrorHandler(t)})}else this.util.show(),this.api.post_public("v1/otp/verifyPhone",{country_code:"+"+this.country_code,mobile:this.mobile,type:"store"}).then(t=>{console.log(t),this.util.hide(),t&&t.status&&200==t.status&&1==t.data&&t.otp_id?(this.otp_id=t.otp_id,this.otpSent=!0):t&&t.status&&500==t.status&&0==t.data&&this.util.error(this.util.translate("Something went wrong"))},t=>{this.util.hide(),this.util.apiErrorHandler(t)}).catch(t=>{this.util.hide(),console.log(t),this.util.apiErrorHandler(t)})}verifyOTP(){if(""==this.otp||null==this.otp||!this.otp)return this.util.error("OTP is required"),!1;console.log(this.otp_id,this.otp,this.util.reset_pwd),0==this.util.reset_pwd?this.verifyEmailOTP():"2"==this.util.smsGateway&&1==this.util.reset_pwd?this.verifyFirebaseOTP():1==this.util.reset_pwd&&"2"!=this.util.smsGateway&&this.verifyPhoneOTP()}verifyEmailOTP(){const t={id:this.otp_id,otp:this.otp,type:"email",email:this.email,country_code:"NA",mobile:"NA"};this.util.show(),this.api.post_public("v1/otp/verifyOTPReset",t).then(t=>{console.log(t),this.util.hide(),t&&t.status&&200===t.status&&t.data&&(this.div=2,this.temp=t.temp,console.log("temp token",this.temp))},t=>(this.util.hide(),console.log(t),t&&401===t.status&&t.error.error||t&&500===t.status&&t.error.error?(this.util.error(t.error.error),!1):(this.util.hide(),void this.util.error(this.util.translate("Wrong OTP"))))).catch(t=>(this.util.hide(),console.log(t),t&&401===t.status&&t.error.error||t&&500===t.status&&t.error.error?(this.util.error(t.error.error),!1):(this.util.hide(),void this.util.error(this.util.translate("Wrong OTP")))))}verifyFirebaseOTP(){this.util.show(),this.api.enterVerificationCode(this.otp).then(t=>{this.util.hide(),this.generateTokenFromCreds(),console.log(t)}).catch(t=>{console.log(t),this.util.hide(),this.util.error(t)})}generateTokenFromCreds(){this.util.show(),this.api.post_public("v1/otp/generateTempToken",{country_code:"+"+this.country_code,mobile:this.mobile}).then(t=>{console.log(t),this.util.hide(),t&&t.status&&200==t.status&&(this.div=2,this.temp=t.temp,console.log("temp token",this.temp))},t=>{this.util.hide(),this.util.apiErrorHandler(t)}).catch(t=>{this.util.hide(),console.log(t),this.util.apiErrorHandler(t)})}verifyPhoneOTP(){const t={id:this.otp_id,otp:this.otp,type:"phone",email:"NA",country_code:"+"+this.country_code,mobile:this.mobile};this.util.show(),this.api.post_public("v1/otp/verifyOTPReset",t).then(t=>{console.log(t),this.util.hide(),t&&t.status&&200===t.status&&t.data&&(this.div=2,this.temp=t.temp,console.log("temp token",this.temp))},t=>(this.util.hide(),console.log(t),t&&401===t.status&&t.error.error||t&&500===t.status&&t.error.error?(this.util.error(t.error.error),!1):(this.util.hide(),void this.util.error(this.util.translate("Wrong OTP"))))).catch(t=>(this.util.hide(),console.log(t),t&&401===t.status&&t.error.error||t&&500===t.status&&t.error.error?(this.util.error(t.error.error),!1):(this.util.hide(),void this.util.error(this.util.translate("Wrong OTP")))))}updatePassword(){return""!=this.password&&null!=this.password&&this.password&&""!=this.confirm&&null!=this.confirm&&this.confirm?this.password!=this.confirm?(this.util.error(this.util.translate("Password does not match")),!1):(console.log("update"),void(0==this.util.reset_pwd?this.updatePasswordWithEmail():"2"==this.util.smsGateway&&1==this.util.reset_pwd?this.updatePasswordFromFirebase():1==this.util.reset_pwd&&"2"!=this.util.smsGateway&&this.updatePasswordWithPhone())):(this.util.error("Password is required"),!1)}updatePasswordWithEmail(){const t={id:this.otp_id,email:this.email,password:this.password};this.util.show(),this.api.post_temp("v1/password/updateUserPasswordWithEmail",t,this.temp).then(t=>{console.log(t),this.util.hide(),t&&t.status&&200===t.status&&t.data&&(n.a.fire({position:"top-end",icon:"success",title:this.util.translate("Password Updated"),showConfirmButton:!1,timer:1500}),this.location.back())},t=>(this.util.hide(),console.log(t),t&&401===t.status&&t.error.error||t&&500===t.status&&t.error.error?(this.util.error(t.error.error),!1):(this.util.hide(),void this.util.error(this.util.translate("Wrong OTP"))))).catch(t=>(this.util.hide(),console.log(t),t&&401===t.status&&t.error.error||t&&500===t.status&&t.error.error?(this.util.error(t.error.error),!1):(this.util.hide(),void this.util.error(this.util.translate("Wrong OTP")))))}updatePasswordFromFirebase(){this.api.post_temp("v1/password/updatePasswordFromFirebase",{country_code:"+"+this.country_code,mobile:this.mobile,password:this.password},this.temp).then(t=>{console.log(t),this.util.hide(),t&&t.status&&200===t.status&&t.data&&(n.a.fire({position:"top-end",icon:"success",title:this.util.translate("Password Updated"),showConfirmButton:!1,timer:1500}),this.location.back())},t=>(this.util.hide(),console.log(t),t&&401===t.status&&t.error.error||t&&500===t.status&&t.error.error?(this.util.error(t.error.error),!1):(this.util.hide(),void this.util.error(this.util.translate("Wrong OTP"))))).catch(t=>(this.util.hide(),console.log(t),t&&401===t.status&&t.error.error||t&&500===t.status&&t.error.error?(this.util.error(t.error.error),!1):(this.util.hide(),void this.util.error(this.util.translate("Wrong OTP")))))}updatePasswordWithPhone(){this.api.post_temp("v1/password/updateUserPasswordWithPhone",{id:this.otp_id,country_code:"+"+this.country_code,mobile:this.mobile,password:this.password,key:"+"+this.country_code+this.mobile},this.temp).then(t=>{console.log(t),this.util.hide(),t&&t.status&&200===t.status&&t.data&&(n.a.fire({position:"top-end",icon:"success",title:this.util.translate("Password Updated"),showConfirmButton:!1,timer:1500}),this.location.back())},t=>(this.util.hide(),console.log(t),t&&401===t.status&&t.error.error||t&&500===t.status&&t.error.error?(this.util.error(t.error.error),!1):(this.util.hide(),void this.util.error(this.util.translate("Wrong OTP"))))).catch(t=>(this.util.hide(),console.log(t),t&&401===t.status&&t.error.error||t&&500===t.status&&t.error.error?(this.util.error(t.error.error),!1):(this.util.hide(),void this.util.error(this.util.translate("Wrong OTP")))))}}return t.\u0275fac=function(i){return new(i||t)(a.Vb(r.a),a.Vb(s.a),a.Vb(e.h))},t.\u0275cmp=a.Pb({type:t,selectors:[["app-forgot"]],decls:14,vars:4,consts:[["id","sign-in-button"],[1,"app-body"],[1,"main","d-flex","align-items-center","login"],[1,"container"],[1,"row"],[1,"col-md-6","mx-auto"],[1,"card-group"],[1,"card","p-4"],[1,"card-body"],[4,"ngIf"],[2,"text-align","center"],["src","assets/img/brand/big_logo.png",1,"logo"],[1,"text-muted"],[1,"input-group","mb-3"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"cil-at"],["type","email","autocomplete","email","required","",1,"form-control",3,"ngModel","placeholder","ngModelOptions","ngModelChange"],["class","otp_content",4,"ngIf"],[1,"col-6"],["type","button","class","btn btn-primary px-4",3,"click",4,"ngIf"],[1,"otp_content"],[3,"config","onInputChange"],["type","button",1,"btn","btn-primary","px-4",3,"click"],[1,"input-group","mb-4"],[1,"icon-lock"],["type","password","autocomplete","current-password","required","",1,"form-control",3,"ngModel","placeholder","ngModelOptions","ngModelChange"],[1,"col-3"],[1,"col-9"],[1,"cil-phone"],["type","number","autocomplete","phone","required","",1,"form-control",3,"ngModel","placeholder","ngModelOptions","ngModelChange"],["id","ccmonth",1,"form-control",3,"ngModel","ngModelOptions","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["type","tel","autocomplete","phone","required","",1,"form-control",3,"ngModel","placeholder","disabled","ngModelOptions","ngModelChange"]],template:function(t,i){1&t&&(a.Wb(0,"ngx-spinner"),a.Wb(1,"div",0),a.bc(2,"div",1),a.bc(3,"main",2),a.bc(4,"div",3),a.bc(5,"div",4),a.bc(6,"div",5),a.bc(7,"div",6),a.bc(8,"div",7),a.bc(9,"div",8),a.Gc(10,w,17,9,"form",9),a.Gc(11,P,21,11,"form",9),a.Gc(12,I,22,11,"form",9),a.Gc(13,C,21,11,"form",9),a.ac(),a.ac(),a.ac(),a.ac(),a.ac(),a.ac(),a.ac(),a.ac()),2&t&&(a.Jb(10),a.rc("ngIf",0==i.util.reset_pwd&&1==i.div),a.Jb(1),a.rc("ngIf",0==i.util.reset_pwd&&2==i.div),a.Jb(1),a.rc("ngIf",1==i.util.reset_pwd&&1==i.div),a.Jb(1),a.rc("ngIf",1==i.util.reset_pwd&&2==i.div))},directives:[u.a,e.l,h.q,h.h,h.i,h.a,h.o,h.g,h.j,d.a,h.l,h.p,e.k,h.k,h.r],styles:[""]}),t})();var k=o("iInd");const H=[{path:"",component:W}];let B=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=a.Tb({type:t}),t.\u0275inj=a.Sb({imports:[[k.g.forChild(H)],k.g]}),t})(),S=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=a.Tb({type:t}),t.\u0275inj=a.Sb({imports:[[e.c,B,h.e,u.b,d.b]]}),t})()}}]);