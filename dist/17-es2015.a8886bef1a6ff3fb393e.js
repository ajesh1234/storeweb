(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{uCiB:function(t,i,e){"use strict";e.r(i),e.d(i,"SupportModule",function(){return I});var n=e("SVse"),s=e("7g+E"),c=e("iInd"),o=e("H+bZ"),a=e("2Rin"),r=e("8Y7J"),d=e("WzhS"),l=e("s7LF");const g=["scrollMe"],m=["messages"];function p(t,i){if(1&t&&(r.bc(0,"div",16),r.bc(1,"div",17),r.Wb(2,"img",18),r.bc(3,"label",19),r.Hc(4),r.Wb(5,"br"),r.bc(6,"span",20),r.Hc(7),r.ac(),r.ac(),r.ac(),r.ac()),2&t){const t=r.lc();r.Jb(2),r.rc("src",t.api.mediaURL+t.avtar,r.Dc),r.Jb(2),r.Jc("",t.name," "),r.Jb(3),r.Ic(t.type)}}function h(t,i){if(1&t){const t=r.cc();r.bc(0,"div",21),r.ic("click",function(){return r.Bc(t),r.lc().admin()}),r.bc(1,"div",22),r.Wb(2,"img",23),r.bc(3,"label",19),r.Hc(4),r.Wb(5,"br"),r.Wb(6,"span",24),r.ac(),r.ac(),r.ac()}if(2&t){const t=r.lc();r.rc("id",t.util.adminInfo.id),r.Jb(4),r.Kc(" ",t.util.adminInfo.first_name+" "+t.util.adminInfo.last_name," - (",t.util.translate("Administrator"),") ")}}function b(t,i){if(1&t){const t=r.cc();r.bc(0,"div",27),r.ic("click",function(){r.Bc(t);const i=r.lc().$implicit;return r.lc().chatUser(i.participants,i.receiver_type,i.receiver_name+" "+i.receiver_last_name)}),r.Wb(1,"img",18),r.bc(2,"label",19),r.Hc(3),r.ac(),r.ac()}if(2&t){const t=r.lc().$implicit,i=r.lc();r.Jb(1),r.rc("src",i.api.mediaURL+t.receiver_cover,r.Dc),r.Jb(2),r.Jc("",t.receiver_name+" "+t.receiver_last_name," ")}}function u(t,i){if(1&t){const t=r.cc();r.bc(0,"div",27),r.ic("click",function(){r.Bc(t);const i=r.lc().$implicit;return r.lc().chatUser(i.uid,i.sender_type,i.sender_first_name+" "+i.sender_last_name)}),r.Wb(1,"img",18),r.bc(2,"label",19),r.Hc(3),r.ac(),r.ac()}if(2&t){const t=r.lc().$implicit,i=r.lc();r.Jb(1),r.rc("src",i.api.mediaURL+t.sender_cover,r.Dc),r.Jb(2),r.Jc("",t.sender_first_name+" "+t.sender_last_name," ")}}function f(t,i){if(1&t&&(r.bc(0,"div",25),r.Gc(1,b,4,2,"div",26),r.Gc(2,u,4,2,"div",26),r.ac()),2&t){const t=i.$implicit,e=r.lc();r.rc("id",e.uid==t.uid?t.participants:t.uid),r.Jb(1),r.rc("ngIf",e.uid==t.uid),r.Jb(1),r.rc("ngIf",e.uid!=t.uid)}}function v(t,i){1&t&&(r.bc(0,"div",28),r.bc(1,"div",22),r.Wb(2,"ngx-skeleton-loader",29),r.ac(),r.ac())}function _(t,i){if(1&t&&(r.bc(0,"div",33),r.bc(1,"div",34),r.bc(2,"div",35),r.Hc(3),r.ac(),r.ac(),r.Wb(4,"div",36),r.ac()),2&t){const t=r.lc().$implicit;r.Jb(3),r.Jc(" ",t.message," ")}}function x(t,i){if(1&t&&(r.bc(0,"div",37),r.bc(1,"div",34),r.bc(2,"div",35),r.Hc(3),r.ac(),r.ac(),r.Wb(4,"div",38),r.ac()),2&t){const t=r.lc().$implicit;r.Jb(3),r.Jc(" ",t.message," ")}}function y(t,i){if(1&t&&(r.bc(0,"span",null,30),r.Gc(2,_,5,1,"div",31),r.Gc(3,x,5,1,"div",32),r.ac()),2&t){const t=i.$implicit,e=r.lc();r.Jb(2),r.rc("ngIf",t.from_id==e.uid),r.Jb(1),r.rc("ngIf",t.from_id!=e.uid)}}function w(t,i){if(1&t){const t=r.cc();r.bc(0,"div",39),r.bc(1,"input",40),r.ic("ngModelChange",function(i){return r.Bc(t),r.lc().message=i})("keydown.enter",function(){return r.Bc(t),r.lc().send()}),r.ac(),r.bc(2,"button",41),r.ic("click",function(){return r.Bc(t),r.lc().send()}),r.Wb(3,"i",42),r.ac(),r.ac()}if(2&t){const t=r.lc();r.Jb(1),r.rc("ngModel",t.message)("placeholder",t.util.translate("Send Message"))}}const C=[{path:"",component:(()=>{class t{constructor(t,i){this.util=t,this.api=i,this.users=[],this.dummy=[],this.dummyList=Array(5),this.messages=[],this.roomId="",this.uid=parseInt(localStorage.getItem("uid")),this.getList()}canDeactivate(){console.log("ok")}getList(){this.users=[],this.dummy=[],this.getChatList()}getChatList(){this.dummyList=Array(5),this.api.post_private("v1/chats/getChatListBUid",{id:this.uid}).then(t=>{console.log(t),this.dummyList=[],t&&t.status&&t.data&&t.data.length&&(this.users=t.data)},t=>{console.log(t),this.dummyList=[],this.util.apiErrorHandler(t)}).catch(t=>{console.log(t),this.dummyList=[],this.util.apiErrorHandler(t)})}ngOnInit(){}search(t){console.log(t)}getChatRooms(){this.api.post_private("v1/chats/getChatRooms",{uid:this.uid,participants:this.id}).then(t=>{console.log(t),t&&t.status&&200===t.status?(t&&t.data&&t.data.id?this.roomId=t.data.id:t&&t.data2&&t.data2.id&&(this.roomId=t.data2.id),this.getMessageList(),this.interval=setInterval(()=>{console.log("calling in interval"),this.getMessageList()},12e3)):this.createChatRooms()},t=>{console.log("error",t),this.createChatRooms()}).catch(t=>{this.createChatRooms(),console.log("error",t)})}createChatRooms(){this.api.post_private("v1/chats/createChatRooms",{uid:this.uid,participants:this.id,status:1}).then(t=>{console.log(t),t&&t.status&&200===t.status&&t.data&&(this.roomId=t.data.id,this.getMessageList(),this.interval=setInterval(()=>{console.log("calling in interval"),this.getMessageList()},12e3))},t=>{console.log("error",t)}).catch(t=>{console.log("error",t)})}admin(){this.id=this.util.adminInfo.id,this.name=this.util.adminInfo.first_name+" "+this.util.adminInfo.last_name,this.getChatRooms()}chatUser(t,i,e){console.log(t,i,e),this.id=t,this.name=e,this.getChatRooms()}getMessageList(){this.api.post_private("v1/chats/getById",{room_id:this.roomId}).then(t=>{console.log(t),t&&t.status&&200===t.status&&t.data.length&&(this.messages=t.data)},t=>{console.log(t)}).catch(t=>{console.log(t)})}send(){if(console.log(this.message),!this.message||""===this.message)return!1;const t=this.message;this.message="",this.api.post_private("v1/chats/sendMessage",{room_id:this.roomId,uid:this.uid,from_id:this.uid,message:t,message_type:0,status:1}).then(t=>{console.log(t),t&&200===t.status&&this.getMessageList()},t=>{console.log(t)})}}return t.\u0275fac=function(i){return new(i||t)(r.Vb(a.a),r.Vb(o.a))},t.\u0275cmp=r.Pb({type:t,selectors:[["app-support"]],viewQuery:function(t,i){if(1&t&&(r.Lc(g,1),r.Lc(m,1)),2&t){let t;r.yc(t=r.jc())&&(i.myScrollContainer=t.first),r.yc(t=r.jc())&&(i.messagesList=t)}},hostBindings:function(t,i){1&t&&r.ic("beforeunload",function(){return i.canDeactivate()},!1,r.Ac)},decls:18,vars:8,consts:[[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[1,"card-body","reset-table","p-t-0"],[1,"form-group","row",2,"height","60vh","border","1px solid lightgray"],[1,"col-sm-4",2,"height","60vh","overflow","scroll","padding","0px","border-right","1px solid lightgray"],["style","border-bottom: 1px solid lightgray;padding: 10px;margin: 10px;background: lightcoral;color: white;",4,"ngIf"],["style","border-bottom: 1px solid lightgray;padding: 10px;margin: 10px;",3,"id","click",4,"ngIf"],["style","border-bottom: 1px solid lightgray;padding: 10px;margin: 10px;",3,"id",4,"ngFor","ngForOf"],["style","border-bottom: 1px solid lightgray;padding: 10px;margin: 10px;",4,"ngFor","ngForOf"],[1,"col-sm-8",2,"height","60vh","overflow","scroll","position","relative"],[1,"lower_div",3,"scrollTop"],["scrollMe",""],[4,"ngFor","ngForOf"],["style","position: absolute;bottom: 10px;width: 90%;display: flex;flex-direction: row;justify-content: space-between;align-items: center;",4,"ngIf"],[2,"border-bottom","1px solid lightgray","padding","10px","margin","10px","background","lightcoral","color","white"],[2,"display","flex"],["onError","this.src='assets/imgs/user.png'","alt","chat-user",1,"img-responsive",2,"height","40px","width","40px","border-radius","50%",3,"src"],[2,"margin-left","10px"],[2,"font-size",".6rem","color","white"],[2,"border-bottom","1px solid lightgray","padding","10px","margin","10px",3,"id","click"],[2,"display","flex","align-items","center"],["src","assets/imgs/user.png","onError","this.src='assets/imgs/user.png'","alt","chat-user",1,"img-responsive",2,"height","40px","width","40px","border-radius","50%"],[2,"font-size",".6rem","color","gray"],[2,"border-bottom","1px solid lightgray","padding","10px","margin","10px",3,"id"],["style","display:flex;align-items: center;",3,"click",4,"ngIf"],[2,"display","flex","align-items","center",3,"click"],[2,"border-bottom","1px solid lightgray","padding","10px","margin","10px"],["count","1","appearance","line",2,"width","100%"],["messages",""],["class","main_div_right",4,"ngIf"],["class","main_div_left",4,"ngIf"],[1,"main_div_right"],[1,"msg_div"],[1,"inner_msg"],[1,"tri_right"],[1,"main_div_left"],[1,"tri_left"],[2,"position","absolute","bottom","10px","width","90%","display","flex","flex-direction","row","justify-content","space-between","align-items","center"],["type","text",1,"form-control","form-control-round",3,"ngModel","placeholder","ngModelChange","keydown.enter"],[1,"btn","btn-danger","btn-icon",2,"margin-left","10px",3,"click"],[1,"cil-send"]],template:function(t,i){if(1&t&&(r.bc(0,"div",0),r.bc(1,"div",1),r.bc(2,"div",2),r.bc(3,"div",3),r.bc(4,"h5"),r.Hc(5),r.ac(),r.ac(),r.bc(6,"div",4),r.bc(7,"div",5),r.bc(8,"div",6),r.Gc(9,p,8,3,"div",7),r.Gc(10,h,7,3,"div",8),r.Gc(11,f,3,3,"div",9),r.Gc(12,v,3,0,"div",10),r.ac(),r.bc(13,"div",11),r.bc(14,"div",12,13),r.Gc(16,y,4,2,"span",14),r.ac(),r.Gc(17,w,4,2,"div",15),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac()),2&t){const t=r.zc(15);r.Jb(5),r.Jc("",i.util.translate("Support")," "),r.Jb(4),r.rc("ngIf",i.selectedId),r.Jb(1),r.rc("ngIf",i.util&&i.util.adminInfo&&i.util.adminInfo.id),r.Jb(1),r.rc("ngForOf",i.users),r.Jb(1),r.rc("ngForOf",i.dummyList),r.Jb(2),r.rc("scrollTop",t.scrollHeight),r.Jb(2),r.rc("ngForOf",i.messages),r.Jb(1),r.rc("ngIf",i.id)}},directives:[n.l,n.k,d.a,l.a,l.g,l.j],styles:[".lower_div[_ngcontent-%COMP%]{padding:20px;height:50vh;overflow:scroll}.lower_div[_ngcontent-%COMP%]   .main_div_right[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:flex-end;position:relative}.lower_div[_ngcontent-%COMP%]   .main_div_right[_ngcontent-%COMP%]   .msg_div[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;width:80%;margin-bottom:15px}.lower_div[_ngcontent-%COMP%]   .main_div_right[_ngcontent-%COMP%]   .msg_div[_ngcontent-%COMP%]   .inner_msg[_ngcontent-%COMP%]{background-color:#f0eff5;padding:10px;border-radius:5px}.lower_div[_ngcontent-%COMP%]   .main_div_right[_ngcontent-%COMP%]   .tri_right[_ngcontent-%COMP%]{width:0;height:0;position:absolute;border-top:10px solid #f0eff5;border-left:10px solid transparent;bottom:10px}.lower_div[_ngcontent-%COMP%]   .main_div_left[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:flex-start;position:relative}.lower_div[_ngcontent-%COMP%]   .main_div_left[_ngcontent-%COMP%]   .msg_div[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;width:80%;margin-bottom:15px}.lower_div[_ngcontent-%COMP%]   .main_div_left[_ngcontent-%COMP%]   .msg_div[_ngcontent-%COMP%]   .inner_msg[_ngcontent-%COMP%]{background-color:gray;padding:10px;border-radius:5px;color:#fff}.lower_div[_ngcontent-%COMP%]   .main_div_left[_ngcontent-%COMP%]   .tri_left[_ngcontent-%COMP%]{width:0;height:0;position:absolute;border-top:10px solid gray;border-right:10px solid transparent;bottom:10px}"]}),t})()}];let M=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=r.Tb({type:t}),t.\u0275inj=r.Sb({imports:[[c.g.forChild(C)],c.g]}),t})(),I=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=r.Tb({type:t}),t.\u0275inj=r.Sb({imports:[[n.c,M,s.b,d.b,l.e]]}),t})()}}]);